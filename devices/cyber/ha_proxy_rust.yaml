apiVersion: punchline.punchplatform.io/v2
kind: BatchPunchline
metadata:
  name: haproxy-rust
  annotations:
    prometheus.io/scrape: 'false'
    punchplatform.thalesdigital.io/platform: platform
    devices.punchplatform.com/id: zone-europe-west1-haproxy-rust-h1
    devices.punchplatform.com/version: "3.1"
    devices.punchplatform.com/inactivityTimeout: "30"
    devices.punchplatform.com/refreshIntervalSeconds: "10"
    devices.punchplatform.com/vendor: "iot.punchplatform.com"
    devices.punchplatform.com/adminUrl: "http://artifacts-server.punch:8080/v1/devices/device"
    metrics.punchplatform.com/pushGatewayUrl: http://artifacts-server.punch:8080
    metrics.punchplatform.com/pushIntervalSeconds: '10'
spec:
  containers:
    applicationContainer:
      image: ghcr.io/punchplatform/rline:0.1-dev
  dag:
    - id: input
      kind: source
      type: generator
      settings:
        interval: 1000
        messages_column:
          - data: "<35> Nov 14 16:14:14 server2.punch.com 92.149.90.114:16346 [12/Jul/2021:05:54:55.077] myproxy http_back/back3 41/104/1/3936/7638 200 22112 - - ---- 5/2/2/5/41 3/3 \"GET /persons/astronauts/i-to-l/lousmaJR.txt HTTP/1.0\""
      out:
        - id: sink
          table: logs
          columns:
            - name: data
              type: string
    - id: sink
      type: http
      kind: sink
      engine_settings:
        tick_row_frequency_ms: 1000
      settings:
        debug: false
        bulk_size: 1000
        url: http://ingestion.punchplatform.com:8090/


